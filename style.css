// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Mini App
let tg = window.Telegram.WebApp;
tg.expand(); // –†–∞—Å–∫—Ä—ã–≤–∞–µ–º –Ω–∞ –≤–µ—Å—å —ç–∫—Ä–∞–Ω
tg.ready();

// –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–∏—Ç–æ–º—Ü–∞
let petState = {
    hunger: 50,
    mood: 50,
    level: 1,
    stars: 0
};

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
function updateStats() {
    document.getElementById('hunger').textContent = petState.hunger;
    document.getElementById('mood').textContent = petState.mood;
    document.getElementById('level').textContent = petState.level;
}

// –î–µ–π—Å—Ç–≤–∏—è —Å –ø–∏—Ç–æ–º—Ü–µ–º
function feed() {
    if (petState.hunger < 100) {
        petState.hunger += 15;
        if (petState.hunger > 100) petState.hunger = 100;
        updateStats();
        showNotification('üçñ –ü–∏—Ç–æ–º–µ—Ü –ø–æ–∫–æ—Ä–º–ª–µ–Ω! +15 –∫ —Å—ã—Ç–æ—Å—Ç–∏');
        animatePet();
    } else {
        showNotification('üêæ –ü–∏—Ç–æ–º–µ—Ü —É–∂–µ —Å—ã—Ç!');
    }
}

function play() {
    if (petState.mood < 100) {
        petState.mood += 12;
        petState.hunger -= 8;
        if (petState.mood > 100) petState.mood = 100;
        if (petState.hunger < 0) petState.hunger = 0;
        updateStats();
        showNotification('üéæ –ü–∏—Ç–æ–º–µ—Ü –ø–æ–∏–≥—Ä–∞–ª! +12 –∫ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—é');
        animatePet();
    } else {
        showNotification('üêæ –ü–∏—Ç–æ–º–µ—Ü —É–∂–µ —Å—á–∞—Å—Ç–ª–∏–≤!');
    }
}

// –ê–Ω–∏–º–∞—Ü–∏—è –ø–∏—Ç–æ–º—Ü–∞
function animatePet() {
    const petImage = document.getElementById('pet-image');
    petImage.style.animation = 'none';
    setTimeout(() => {
        petImage.style.animation = 'bounce 0.5s ease-in-out';
    }, 10);
}

// –ú–∞–≥–∞–∑–∏–Ω
function openShop() {
    document.getElementById('shop').classList.remove('hidden');
}

function closeShop() {
    document.getElementById('shop').classList.add('hidden');
}

function buyItem(item) {
    showNotification('üéâ –°–∫–æ—Ä–æ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø–æ–∫—É–ø–∞—Ç—å –∑–∞ –∑–≤—ë–∑–¥—ã!');
    // –ó–¥–µ—Å—å –ø–æ–∑–∂–µ –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ –ø–ª–∞—Ç–µ–∂–Ω–æ–≥–æ API Telegram
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è
function showNotification(message) {
    // –ü—Ä–æ—Å—Ç–æ–π alert –¥–ª—è –Ω–∞—á–∞–ª–∞, –ø–æ—Ç–æ–º –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –∫—Ä–∞—Å–∏–≤—ã–π toast
    alert(message);
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
updateStats();

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–º–µ–Ω—å—à–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º
setInterval(() => {
    if (petState.hunger > 0) petState.hunger -= 1;
    if (petState.mood > 0) petState.mood -= 1;
    updateStats();
}, 30000); // –ö–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
